(window.webpackJsonp=window.webpackJsonp||[]).push([[286],{706:function(t,s,a){"use strict";a.r(s);var n=a(16),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"一、前端进行网络请求的关注点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、前端进行网络请求的关注点"}},[t._v("#")]),t._v(" 一、前端进行网络请求的关注点")]),t._v(" "),a("p",[t._v("大多数情况下，在前端发起一个网络请求我们只需关注下面几点：")]),t._v(" "),a("ul",[a("li",[t._v("传入基本参数（"),a("code",[t._v("url")]),t._v("，请求方式）")]),t._v(" "),a("li",[t._v("请求参数、请求参数类型")]),t._v(" "),a("li",[t._v("设置请求头")]),t._v(" "),a("li",[t._v("获取响应的方式")]),t._v(" "),a("li",[t._v("获取响应头、响应状态、响应结果")]),t._v(" "),a("li",[t._v("异常处理")]),t._v(" "),a("li",[t._v("携带"),a("code",[t._v("cookie")]),t._v("设置")]),t._v(" "),a("li",[t._v("跨域请求")])]),t._v(" "),a("h2",{attrs:{id:"二、前端进行网络请求的方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、前端进行网络请求的方式"}},[t._v("#")]),t._v(" 二、前端进行网络请求的方式")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("form")]),t._v("表单、"),a("code",[t._v("ifream")]),t._v("、刷新页面")]),t._v(" "),a("li",[a("code",[t._v("Ajax")]),t._v(" - 异步网络请求的开山鼻祖")]),t._v(" "),a("li",[a("code",[t._v("jQuery")]),t._v(" - 一个时代")]),t._v(" "),a("li",[a("code",[t._v("fetch")]),t._v(" - "),a("code",[t._v("Ajax")]),t._v("的替代者")]),t._v(" "),a("li",[a("code",[t._v("axios、request")]),t._v("等众多开源库")])]),t._v(" "),a("h2",{attrs:{id:"三、关于网络请求的疑问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、关于网络请求的疑问"}},[t._v("#")]),t._v(" 三、关于网络请求的疑问")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Ajax")]),t._v("的出现解决了什么问题")]),t._v(" "),a("li",[t._v("原生"),a("code",[t._v("Ajax")]),t._v("如何使用")]),t._v(" "),a("li",[a("code",[t._v("jQuery")]),t._v("的网络请求方式")]),t._v(" "),a("li",[a("code",[t._v("fetch")]),t._v("的用法以及坑点")]),t._v(" "),a("li",[t._v("如何正确的使用"),a("code",[t._v("fetch")])]),t._v(" "),a("li",[t._v("如何选择合适的跨域方式")])]),t._v(" "),a("p",[t._v("带着以上这些问题、关注点我们对几种网络请求进行一次全面的分析。")]),t._v(" "),a("h2",{attrs:{id:"四、ajax-的出现解决了什么问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、ajax-的出现解决了什么问题"}},[t._v("#")]),t._v(" 四、Ajax 的出现解决了什么问题")]),t._v(" "),a("p",[t._v("在"),a("code",[t._v("Ajax")]),t._v("出现之前，"),a("code",[t._v("web")]),t._v("程序是这样工作的：")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://www.conardli.top/img/wl/wlqq_1.png",alt:"image"}})]),t._v(" "),a("p",[t._v("这种交互的的缺陷是显而易见的，任何和服务器的交互都需要刷新页面，用户体验非常差，"),a("code",[t._v("Ajax")]),t._v("的出现解决了这个问题。"),a("code",[t._v("Ajax")]),t._v("全称"),a("code",[t._v("Asynchronous JavaScript + XML")]),t._v("（异步"),a("code",[t._v("JavaScript")]),t._v("和"),a("code",[t._v("XML")]),t._v("）")]),t._v(" "),a("p",[t._v("使用"),a("code",[t._v("Ajax")]),t._v("，网页应用能够快速地将增量更新呈现在用户界面上，而不需要重载（刷新）整个页面。")]),t._v(" "),a("p",[a("code",[t._v("Ajax")]),t._v("本身不是一种新技术，而是用来描述一种使用现有技术集合实现的一个技术方案，浏览器的"),a("code",[t._v("XMLHttpRequest")]),t._v("是实现"),a("code",[t._v("Ajax")]),t._v("最重要的对象（"),a("code",[t._v("IE6")]),t._v("以下使用"),a("code",[t._v("ActiveXObject")]),t._v("）。")]),t._v(" "),a("p",[t._v("尽管"),a("code",[t._v("X")]),t._v("在"),a("code",[t._v("Ajax")]),t._v("中代表"),a("code",[t._v("XML")]),t._v(", 但由于"),a("code",[t._v("JSON")]),t._v("的许多优势，比如更加轻量以及作为"),a("code",[t._v("Javascript")]),t._v("的一部分，目前"),a("code",[t._v("JSON")]),t._v("的使用比"),a("code",[t._v("XML")]),t._v("更加普遍。")]),t._v(" "),a("h2",{attrs:{id:"五、原生-ajax-的用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、原生-ajax-的用法"}},[t._v("#")]),t._v(" 五、原生 Ajax 的用法")]),t._v(" "),a("p",[t._v("这里主要分析"),a("code",[t._v("XMLHttpRequest")]),t._v("对象，下面是它的一段基础使用：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" xhr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'post'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'www.xxx.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 接收返回值")]),t._v("\n        xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onreadystatechange")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("304")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 处理请求参数")]),t._v("\n        postData "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"name1"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"name2"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        postData "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" dataString "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" key "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n             dataString "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"="')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" dataString"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("postData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置请求头")]),t._v("\n        xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRequestHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-type"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/x-www-form-urlencoded"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 异常处理")]),t._v("\n        xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onerror")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n           console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Network request failed'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 跨域携带cookie")]),t._v("\n        xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("withCredentials "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 发出请求")]),t._v("\n        xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("postData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br")])]),a("p",[t._v("下面分别对"),a("code",[t._v("XMLHttpRequest")]),t._v("对象常用的的函数、属性、事件进行分析。")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://www.conardli.top/img/wl/wlqq_2.png",alt:"image"}})]),t._v(" "),a("h3",{attrs:{id:"函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#函数"}},[t._v("#")]),t._v(" 函数")]),t._v(" "),a("p",[a("strong",[t._v("open")])]),t._v(" "),a("p",[t._v("用于初始化一个请求，用法：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" async"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("ul",[a("li",[a("code",[t._v("method")]),t._v("：请求方式，如"),a("code",[t._v("get、post")])]),t._v(" "),a("li",[a("code",[t._v("url")]),t._v("：请求的"),a("code",[t._v("url")])]),t._v(" "),a("li",[a("code",[t._v("async")]),t._v("：是否为异步请求")])]),t._v(" "),a("p",[a("strong",[t._v("send")])]),t._v(" "),a("p",[t._v("用于发送"),a("code",[t._v("HTTP")]),t._v("请求，即调用该方法后"),a("code",[t._v("HTTP")]),t._v("请求才会被真正发出，用法：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("param"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("ul",[a("li",[a("code",[t._v("param")]),t._v("：http 请求的参数，可以为"),a("code",[t._v("string、Blob")]),t._v("等类型。")])]),t._v(" "),a("p",[a("strong",[t._v("abort")])]),t._v(" "),a("p",[t._v("用于终止一个"),a("code",[t._v("ajax")]),t._v("请求，调用此方法后"),a("code",[t._v("readyState")]),t._v("将被设置为"),a("code",[t._v("0")]),t._v("，用法：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("abort")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[a("strong",[t._v("setRequestHeader")])]),t._v(" "),a("p",[t._v("用于设置"),a("code",[t._v("HTTP")]),t._v("请求头，此方法必须在"),a("code",[t._v("open()")]),t._v("方法和"),a("code",[t._v("send()")]),t._v("之间调用，用法：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRequestHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("header"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[a("strong",[t._v("getResponseHeader")])]),t._v(" "),a("p",[t._v("用于获取"),a("code",[t._v("http")]),t._v("返回头，如果在返回头中有多个一样的名称，那么返回的值就会是用逗号和空格将值分隔的字符串，用法：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" header "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getResponseHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h3",{attrs:{id:"属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#属性"}},[t._v("#")]),t._v(" 属性")]),t._v(" "),a("p",[a("strong",[t._v("readyState")])]),t._v(" "),a("p",[t._v("用来标识当前"),a("code",[t._v("XMLHttpRequest")]),t._v("对象所处的状态，"),a("code",[t._v("XMLHttpRequest")]),t._v("对象总是位于下列状态中的一个：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("值")]),t._v(" "),a("th",[t._v("状态")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("0")]),t._v(" "),a("td",[a("code",[t._v("UNSENT")])]),t._v(" "),a("td",[t._v("代理被创建，但尚未调用 "),a("code",[t._v("open()")]),t._v(" 方法。")])]),t._v(" "),a("tr",[a("td",[t._v("1")]),t._v(" "),a("td",[a("code",[t._v("OPENED")])]),t._v(" "),a("td",[a("code",[t._v("open()")]),t._v(" 方法已经被调用。")])]),t._v(" "),a("tr",[a("td",[t._v("2")]),t._v(" "),a("td",[a("code",[t._v("HEADERS_RECEIVED")])]),t._v(" "),a("td",[a("code",[t._v("send()")]),t._v("方法已经被调用，并且头部和状态已经可获得。")])]),t._v(" "),a("tr",[a("td",[t._v("3")]),t._v(" "),a("td",[a("code",[t._v("LOADING")])]),t._v(" "),a("td",[t._v("下载中； "),a("code",[t._v("responseText")]),t._v(" 属性已经包含部分数据。")])]),t._v(" "),a("tr",[a("td",[t._v("4")]),t._v(" "),a("td",[a("code",[t._v("DONE")])]),t._v(" "),a("td",[t._v("下载操作已完成。")])])])]),t._v(" "),a("p",[a("strong",[t._v("status")])]),t._v(" "),a("p",[t._v("表示"),a("code",[t._v("http")]),t._v("请求的状态, 初始值为"),a("code",[t._v("0")]),t._v("。如果服务器没有显式地指定状态码, 那么"),a("code",[t._v("status")]),t._v("将被设置为默认值, 即"),a("code",[t._v("200")]),t._v("。")]),t._v(" "),a("p",[a("strong",[t._v("responseType")])]),t._v(" "),a("p",[t._v("表示响应的数据类型，并允许我们手动设置，如果为空，默认为"),a("code",[t._v("text")]),t._v("类型，可以有下面的取值：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("值")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v('""')])]),t._v(" "),a("td",[t._v("将 "),a("code",[t._v("responseType")]),t._v("设为空字符串与设置为"),a("code",[t._v('"text"')]),t._v("相同， 是默认类型 （实际上是 "),a("code",[t._v("DOMString")]),t._v("）。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v('"arraybuffer"')])]),t._v(" "),a("td",[a("code",[t._v("response")]),t._v(" 是一个包含二进制数据的"),a("code",[t._v("JavaScript ArrayBuffer")]),t._v(" 。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v('"blob"')])]),t._v(" "),a("td",[a("code",[t._v("response")]),t._v("是一个包含二进制数据的 "),a("code",[t._v("Blob")]),t._v(" 对象 。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v('"document"')])]),t._v(" "),a("td",[t._v("response 是一个"),a("code",[t._v("HTML Document")]),t._v("或"),a("code",[t._v("XML XMLDocument")]),t._v("，这取决于接收到的数据的 MIME 类型。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v('"json"')])]),t._v(" "),a("td",[a("code",[t._v("response")]),t._v(" 是一个 JavaScript 对象。这个对象是通过将接收到的数据类型视为"),a("code",[t._v("JSON")]),t._v("解析得到的。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v('"text"')])]),t._v(" "),a("td",[a("code",[t._v("response")]),t._v("是包含在"),a("code",[t._v("DOMString")]),t._v("对象中的文本。")])])])]),t._v(" "),a("p",[a("strong",[t._v("response")])]),t._v(" "),a("p",[t._v("返回响应的正文，返回的类型由上面的"),a("code",[t._v("responseType")]),t._v("决定。")]),t._v(" "),a("p",[a("strong",[t._v("withCredentials")])]),t._v(" "),a("p",[a("code",[t._v("ajax")]),t._v("请求默认会携带同源请求的"),a("code",[t._v("cookie")]),t._v("，而跨域请求则不会携带"),a("code",[t._v("cookie")]),t._v("，设置"),a("code",[t._v("xhr")]),t._v("的"),a("code",[t._v("withCredentials")]),t._v("的属性为"),a("code",[t._v("true")]),t._v("将允许携带跨域"),a("code",[t._v("cookie")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"事件回调"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事件回调"}},[t._v("#")]),t._v(" 事件回调")]),t._v(" "),a("p",[a("strong",[t._v("onreadystatechange")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onreadystatechange "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("当"),a("code",[t._v("readyState")]),t._v("属性发生变化时，callback 会被触发。")]),t._v(" "),a("p",[a("strong",[t._v("onloadstart")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onloadstart "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("在"),a("code",[t._v("ajax")]),t._v("请求发送之前（"),a("code",[t._v("readyState==1")]),t._v("后, "),a("code",[t._v("readyState==2")]),t._v("前），"),a("code",[t._v("callback")]),t._v("会被触发。")]),t._v(" "),a("p",[a("strong",[t._v("onprogress")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onprogress")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("loaded "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("total"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("回调函数可以获取资源总大小"),a("code",[t._v("total")]),t._v("，已经加载的资源大小"),a("code",[t._v("loaded")]),t._v("，用这两个值可以计算加载进度。")]),t._v(" "),a("p",[a("strong",[t._v("onload")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onload "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("当一个资源及其依赖资源已完成加载时，将触发"),a("code",[t._v("callback")]),t._v("，通常我们会在"),a("code",[t._v("onload")]),t._v("事件中处理返回值。")]),t._v(" "),a("h3",{attrs:{id:"异常处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#异常处理"}},[t._v("#")]),t._v(" 异常处理")]),t._v(" "),a("p",[a("strong",[t._v("onerror")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onerror "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("当"),a("code",[t._v("ajax")]),t._v("资源加载失败时会触发"),a("code",[t._v("callback")]),t._v("。")]),t._v(" "),a("p",[a("strong",[t._v("ontimeout")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ontimeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("当进度由于预定时间到期而终止时，会触发"),a("code",[t._v("callback")]),t._v("，超时时间可使用"),a("code",[t._v("timeout")]),t._v("属性进行设置。")]),t._v(" "),a("h2",{attrs:{id:"六、jquery-对-ajax-的封装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、jquery-对-ajax-的封装"}},[t._v("#")]),t._v(" 六、jQuery 对 Ajax 的封装")]),t._v(" "),a("p",[t._v("在很长一段时间里，人们使用"),a("code",[t._v("jQuery")]),t._v("提供的"),a("code",[t._v("ajax")]),t._v("封装进行网络请求，包括"),a("code",[t._v("$.ajax、$.get、$.post")]),t._v("等，这几个方法放到现在，我依然觉得很实用。")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ajax")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("dataType")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'json'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置返回值类型")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("contentType")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application/json'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置参数类型")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("headers")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application/json'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置请求头")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("xhrFields")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("withCredentials")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 跨域携带cookie")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("a")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("b")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("a")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 传递参数")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("status")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 错误处理")]),t._v("\n       console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("success")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("status")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取结果")]),t._v("\n       console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("p",[a("code",[t._v("$.ajax")]),t._v("只接收一个参数，这个参数接收一系列配置，其自己封装了一个"),a("code",[t._v("jqXHR")]),t._v("对象，有兴趣可以阅读一下"),a("a",{attrs:{href:"https://github.com/jquery/jquery/blob/master/src/ajax.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("jQuary-ajax 源码"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("img",{attrs:{src:"http://www.conardli.top/img/wl/wlqq_3.png",alt:"image"}})]),t._v(" "),a("p",[t._v("常用配置：")]),t._v(" "),a("p",[a("strong",[t._v("url")])]),t._v(" "),a("p",[t._v("当前页地址。发送请求的地址。")]),t._v(" "),a("p",[a("strong",[t._v("type")])]),t._v(" "),a("p",[t._v("类型："),a("code",[t._v("String")]),t._v(" 请求方式 ("),a("code",[t._v('"POST"')]),t._v(" 或"),a("code",[t._v('"GET"')]),t._v(")， 默认为 "),a("code",[t._v('"GET"')]),t._v("。注意：其它"),a("code",[t._v("HTTP")]),t._v("请求方法，如"),a("code",[t._v("PUT")]),t._v("和 "),a("code",[t._v("DELETE")]),t._v("也可以使用，但仅部分浏览器支持。")]),t._v(" "),a("p",[a("strong",[t._v("timeout")])]),t._v(" "),a("p",[t._v("类型："),a("code",[t._v("Number")]),t._v("设置请求超时时间（毫秒）。此设置将覆盖全局设置。")]),t._v(" "),a("p",[a("strong",[t._v("success")])]),t._v(" "),a("p",[t._v("类型："),a("code",[t._v("Function")]),t._v(" 请求成功后的回调函数。")]),t._v(" "),a("p",[a("strong",[t._v("jsonp")])]),t._v(" "),a("p",[t._v("在一个"),a("code",[t._v("jsonp")]),t._v("请求中重写回调函数的名字。这个值用来替代在"),a("code",[t._v('"callback=?"')]),t._v("这种"),a("code",[t._v("GET")]),t._v("或"),a("code",[t._v("POST")]),t._v("请求中"),a("code",[t._v("URL")]),t._v("参数里的"),a("code",[t._v('"callback"')]),t._v("部分。")]),t._v(" "),a("p",[a("strong",[t._v("error")]),t._v(" 类型："),a("code",[t._v("Function")]),t._v(" 。请求失败时调用此函数。")]),t._v(" "),a("p",[t._v("注意：源码里对错误的判定：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("isSuccess "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("304")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("返回值除了这几个状态码都会进"),a("code",[t._v("error")]),t._v("回调。")]),t._v(" "),a("p",[a("strong",[t._v("dataType")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"xml"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 返回 "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("XML")]),t._v(" 文档，可用 jQuery 处理。\n"),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"html"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 返回纯文本 "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTML")]),t._v(" 信息；包含的 script 标签会在插入 dom 时执行。\n"),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"script"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 返回纯文本 JavaScript 代码。不会自动缓存结果。除非设置了 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cache"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("参数。注意：在远程请求时")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("不在同一个域下"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("，所有 "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("POST")]),t._v(" 请求都将转为 "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GET")]),t._v(" 请求。（因为将使用 "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DOM")]),t._v(" 的 script标签来加载）\n"),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"json"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 返回 "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),t._v(" 数据 。\n"),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"jsonp"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSONP")]),t._v(" 格式。使用 "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSONP")]),t._v(" 形式调用函数时，如 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myurl?callback=?"')]),t._v(" jQuery 将自动替换 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" 为正确的函数名，以执行回调函数。\n"),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"text"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 返回纯文本字符串\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("p",[a("strong",[t._v("data")])]),t._v(" "),a("p",[t._v("类型："),a("code",[t._v("String")]),t._v(" 使用"),a("code",[t._v("JSON.stringify")]),t._v("转码")]),t._v(" "),a("p",[a("strong",[t._v("complete")])]),t._v(" "),a("p",[t._v("类型："),a("code",[t._v("Function")]),t._v("请求完成后回调函数 (请求成功或失败之后均调用)。")]),t._v(" "),a("p",[a("strong",[t._v("async")])]),t._v(" "),a("p",[t._v("类型："),a("code",[t._v("Boolean")]),t._v(" 默认值:"),a("code",[t._v("true")]),t._v("。默认设置下，所有请求均为异步请求。如果需要发送同步请求，请将此选项设置为 "),a("code",[t._v("false")]),t._v("。")]),t._v(" "),a("p",[a("strong",[t._v("contentType")])]),t._v(" "),a("p",[t._v("类型："),a("code",[t._v("String")]),t._v("默认值: "),a("code",[t._v('"application/x-www-form-urlencoded"')]),t._v("。发送信息至服务器时内容编码类型。")]),t._v(" "),a("p",[t._v("键值对这样组织在一般的情况下是没有什么问题的，这里说的一般是，不带嵌套类型"),a("code",[t._v("JSON")]),t._v("，也就是 简单的"),a("code",[t._v("JSON")]),t._v("，形如这样：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("a")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("b")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("c")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[t._v("但是在一些复杂的情况下就有问题了。 例如在 "),a("code",[t._v("Ajax")]),t._v("中你要传一个复杂的 "),a("code",[t._v("json")]),t._v(" 对像，也就说是对象嵌数组，数组中包括对象，你这样传："),a("code",[t._v("application/x-www-form-urlencoded")]),t._v(" 这种形式是没有办法将复杂的"),a("code",[t._v("JSON")]),t._v("组织成键值对形式。")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("a")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("x")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("p",[t._v("可以用如下方式传递复杂的"),a("code",[t._v("json")]),t._v("对象")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ajax")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("dataType")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"json"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("contentType")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/json"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("a")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("b")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("a")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);