<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>NodeSever-Egg | 全栈大前端</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?7cce883071b4e15eb7f6c12bad2eb0d9";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
</script>
    <meta name="description" content="mokinzhao 的前端世界">
    <meta name="baidu-site-verification" content="code-Mu6nhhCufG">
    
    <link rel="preload" href="/assets/css/0.styles.002b7fb3.css" as="style"><link rel="preload" href="/assets/js/app.553118a3.js" as="script"><link rel="preload" href="/assets/js/2.0b4d76ae.js" as="script"><link rel="preload" href="/assets/js/187.520f3a72.js" as="script"><link rel="prefetch" href="/assets/js/10.f46bfd18.js"><link rel="prefetch" href="/assets/js/100.aeb36508.js"><link rel="prefetch" href="/assets/js/101.91190a7b.js"><link rel="prefetch" href="/assets/js/102.cee181a7.js"><link rel="prefetch" href="/assets/js/103.b27182dc.js"><link rel="prefetch" href="/assets/js/104.81d39928.js"><link rel="prefetch" href="/assets/js/105.c7992e4b.js"><link rel="prefetch" href="/assets/js/106.accbd536.js"><link rel="prefetch" href="/assets/js/107.5ae138e2.js"><link rel="prefetch" href="/assets/js/108.0c2988f7.js"><link rel="prefetch" href="/assets/js/109.05a0e472.js"><link rel="prefetch" href="/assets/js/11.d934d5f5.js"><link rel="prefetch" href="/assets/js/110.82516b9b.js"><link rel="prefetch" href="/assets/js/111.ca00039d.js"><link rel="prefetch" href="/assets/js/112.6d5f652f.js"><link rel="prefetch" href="/assets/js/113.3805e587.js"><link rel="prefetch" href="/assets/js/114.042de32d.js"><link rel="prefetch" href="/assets/js/115.75eac969.js"><link rel="prefetch" href="/assets/js/116.793d7497.js"><link rel="prefetch" href="/assets/js/117.816c7fc4.js"><link rel="prefetch" href="/assets/js/118.7c336885.js"><link rel="prefetch" href="/assets/js/119.07d3ae62.js"><link rel="prefetch" href="/assets/js/12.ce5510ef.js"><link rel="prefetch" href="/assets/js/120.539fa2b9.js"><link rel="prefetch" href="/assets/js/121.25ae9c6a.js"><link rel="prefetch" href="/assets/js/122.9df526f8.js"><link rel="prefetch" href="/assets/js/123.f97765d9.js"><link rel="prefetch" href="/assets/js/124.5f4bd9fa.js"><link rel="prefetch" href="/assets/js/125.6b7da648.js"><link rel="prefetch" href="/assets/js/126.f9f9507d.js"><link rel="prefetch" href="/assets/js/127.0af9a9fb.js"><link rel="prefetch" href="/assets/js/128.40541641.js"><link rel="prefetch" href="/assets/js/129.fcbe4a2d.js"><link rel="prefetch" href="/assets/js/13.4e61c201.js"><link rel="prefetch" href="/assets/js/130.1dc32be6.js"><link rel="prefetch" href="/assets/js/131.7547c65f.js"><link rel="prefetch" href="/assets/js/132.bc507b1e.js"><link rel="prefetch" href="/assets/js/133.ab8ccb4b.js"><link rel="prefetch" href="/assets/js/134.9c72e22f.js"><link rel="prefetch" href="/assets/js/135.4e24d73c.js"><link rel="prefetch" href="/assets/js/136.5bcb7bf1.js"><link rel="prefetch" href="/assets/js/137.03fab3a5.js"><link rel="prefetch" href="/assets/js/138.f85b7830.js"><link rel="prefetch" href="/assets/js/139.91b27ce6.js"><link rel="prefetch" href="/assets/js/14.7285fda3.js"><link rel="prefetch" href="/assets/js/140.a7802d98.js"><link rel="prefetch" href="/assets/js/141.a430c6e2.js"><link rel="prefetch" href="/assets/js/142.45e6c58c.js"><link rel="prefetch" href="/assets/js/143.2a7eace6.js"><link rel="prefetch" href="/assets/js/144.ed7bac0c.js"><link rel="prefetch" href="/assets/js/145.d5788348.js"><link rel="prefetch" href="/assets/js/146.8d19409f.js"><link rel="prefetch" href="/assets/js/147.f32e85f8.js"><link rel="prefetch" href="/assets/js/148.c2104078.js"><link rel="prefetch" href="/assets/js/149.9d192e42.js"><link rel="prefetch" href="/assets/js/15.99a11d2d.js"><link rel="prefetch" href="/assets/js/150.3a9c5568.js"><link rel="prefetch" href="/assets/js/151.600fdecb.js"><link rel="prefetch" href="/assets/js/152.d9905be8.js"><link rel="prefetch" href="/assets/js/153.324f4ee2.js"><link rel="prefetch" href="/assets/js/154.7947bd48.js"><link rel="prefetch" href="/assets/js/155.fbde91ae.js"><link rel="prefetch" href="/assets/js/156.586d7e46.js"><link rel="prefetch" href="/assets/js/157.2fb753f4.js"><link rel="prefetch" href="/assets/js/158.70ffc82e.js"><link rel="prefetch" href="/assets/js/159.62b2be17.js"><link rel="prefetch" href="/assets/js/16.e1d9b64a.js"><link rel="prefetch" href="/assets/js/160.cd0fb08d.js"><link rel="prefetch" href="/assets/js/161.ba89a044.js"><link rel="prefetch" href="/assets/js/162.c66a33ba.js"><link rel="prefetch" href="/assets/js/163.5d45e015.js"><link rel="prefetch" href="/assets/js/164.7eec57a6.js"><link rel="prefetch" href="/assets/js/165.8246cb2d.js"><link rel="prefetch" href="/assets/js/166.991776e0.js"><link rel="prefetch" href="/assets/js/167.091a71e8.js"><link rel="prefetch" href="/assets/js/168.04b5cc32.js"><link rel="prefetch" href="/assets/js/169.d954c695.js"><link rel="prefetch" href="/assets/js/17.08f5a0b6.js"><link rel="prefetch" href="/assets/js/170.5ce4d47c.js"><link rel="prefetch" href="/assets/js/171.a5eca02d.js"><link rel="prefetch" href="/assets/js/172.f36acc01.js"><link rel="prefetch" href="/assets/js/173.39857d6a.js"><link rel="prefetch" href="/assets/js/174.fe4fe00a.js"><link rel="prefetch" href="/assets/js/175.d8819248.js"><link rel="prefetch" href="/assets/js/176.937debf0.js"><link rel="prefetch" href="/assets/js/177.6ff15c70.js"><link rel="prefetch" href="/assets/js/178.4dfaaa7f.js"><link rel="prefetch" href="/assets/js/179.bf67a108.js"><link rel="prefetch" href="/assets/js/18.3341ef28.js"><link rel="prefetch" href="/assets/js/180.2e9080d2.js"><link rel="prefetch" href="/assets/js/181.86c153e4.js"><link rel="prefetch" href="/assets/js/182.ef8cb0e1.js"><link rel="prefetch" href="/assets/js/183.322de5f5.js"><link rel="prefetch" href="/assets/js/184.adeec2e5.js"><link rel="prefetch" href="/assets/js/185.6880c183.js"><link rel="prefetch" href="/assets/js/186.d2360924.js"><link rel="prefetch" href="/assets/js/188.cb476f00.js"><link rel="prefetch" href="/assets/js/189.3d4e276e.js"><link rel="prefetch" href="/assets/js/19.cc58a649.js"><link rel="prefetch" href="/assets/js/190.a62e438d.js"><link rel="prefetch" href="/assets/js/191.4cdea883.js"><link rel="prefetch" href="/assets/js/192.970ed86f.js"><link rel="prefetch" href="/assets/js/193.a7b7c153.js"><link rel="prefetch" href="/assets/js/194.abe6c21b.js"><link rel="prefetch" href="/assets/js/195.6b16edb8.js"><link rel="prefetch" href="/assets/js/196.d6c03931.js"><link rel="prefetch" href="/assets/js/197.ebec5dfd.js"><link rel="prefetch" href="/assets/js/198.63ba72b8.js"><link rel="prefetch" href="/assets/js/199.9deb55a5.js"><link rel="prefetch" href="/assets/js/20.37882eb8.js"><link rel="prefetch" href="/assets/js/200.9ce303a2.js"><link rel="prefetch" href="/assets/js/201.6eed052b.js"><link rel="prefetch" href="/assets/js/202.6f18b95c.js"><link rel="prefetch" href="/assets/js/203.45661e8f.js"><link rel="prefetch" href="/assets/js/204.75bb03c2.js"><link rel="prefetch" href="/assets/js/205.5129f068.js"><link rel="prefetch" href="/assets/js/206.c2b35947.js"><link rel="prefetch" href="/assets/js/207.3bef2770.js"><link rel="prefetch" href="/assets/js/208.700dfb5f.js"><link rel="prefetch" href="/assets/js/209.f7cc9881.js"><link rel="prefetch" href="/assets/js/21.77ac0276.js"><link rel="prefetch" href="/assets/js/210.c2508903.js"><link rel="prefetch" href="/assets/js/211.8c1986b0.js"><link rel="prefetch" href="/assets/js/212.ff7072c6.js"><link rel="prefetch" href="/assets/js/213.ce29768f.js"><link rel="prefetch" href="/assets/js/214.2c32e231.js"><link rel="prefetch" href="/assets/js/215.7b5b1089.js"><link rel="prefetch" href="/assets/js/216.3bf01a40.js"><link rel="prefetch" href="/assets/js/217.64945927.js"><link rel="prefetch" href="/assets/js/218.fcd1fd42.js"><link rel="prefetch" href="/assets/js/219.a68bbca2.js"><link rel="prefetch" href="/assets/js/22.2f6de1a9.js"><link rel="prefetch" href="/assets/js/220.e345e6ed.js"><link rel="prefetch" href="/assets/js/221.1a850342.js"><link rel="prefetch" href="/assets/js/222.d269bf63.js"><link rel="prefetch" href="/assets/js/223.7de2cad9.js"><link rel="prefetch" href="/assets/js/224.f4b76224.js"><link rel="prefetch" href="/assets/js/225.b11dcea8.js"><link rel="prefetch" href="/assets/js/226.b7de4c98.js"><link rel="prefetch" href="/assets/js/227.394dd7fd.js"><link rel="prefetch" href="/assets/js/228.97da1154.js"><link rel="prefetch" href="/assets/js/229.fd886313.js"><link rel="prefetch" href="/assets/js/23.f4f790a7.js"><link rel="prefetch" href="/assets/js/230.01ebd63b.js"><link rel="prefetch" href="/assets/js/231.7cadaa29.js"><link rel="prefetch" href="/assets/js/232.05fbb24c.js"><link rel="prefetch" href="/assets/js/233.e5f62071.js"><link rel="prefetch" href="/assets/js/234.8a52f160.js"><link rel="prefetch" href="/assets/js/235.90f9eee3.js"><link rel="prefetch" href="/assets/js/236.d7ff1ffa.js"><link rel="prefetch" href="/assets/js/237.dc0efcde.js"><link rel="prefetch" href="/assets/js/238.71b2ef4c.js"><link rel="prefetch" href="/assets/js/239.b0100a80.js"><link rel="prefetch" href="/assets/js/24.545bd963.js"><link rel="prefetch" href="/assets/js/240.02121857.js"><link rel="prefetch" href="/assets/js/241.9ee0dc30.js"><link rel="prefetch" href="/assets/js/242.8a8fce40.js"><link rel="prefetch" href="/assets/js/243.fcc6ad5f.js"><link rel="prefetch" href="/assets/js/244.6a04538c.js"><link rel="prefetch" href="/assets/js/245.3c0ffb2a.js"><link rel="prefetch" href="/assets/js/246.57e402a3.js"><link rel="prefetch" href="/assets/js/247.f39e73c9.js"><link rel="prefetch" href="/assets/js/248.fa320c5b.js"><link rel="prefetch" href="/assets/js/249.70acd590.js"><link rel="prefetch" href="/assets/js/25.0e23fbaf.js"><link rel="prefetch" href="/assets/js/250.1ec80690.js"><link rel="prefetch" href="/assets/js/251.bb92537d.js"><link rel="prefetch" href="/assets/js/252.72e9e4a4.js"><link rel="prefetch" href="/assets/js/253.95e1ea83.js"><link rel="prefetch" href="/assets/js/254.7938f629.js"><link rel="prefetch" href="/assets/js/255.b49398c2.js"><link rel="prefetch" href="/assets/js/256.7ae1552f.js"><link rel="prefetch" href="/assets/js/257.2ef41f2c.js"><link rel="prefetch" href="/assets/js/258.71de02a9.js"><link rel="prefetch" href="/assets/js/259.d3681375.js"><link rel="prefetch" href="/assets/js/26.575d34d4.js"><link rel="prefetch" href="/assets/js/260.e903b0ce.js"><link rel="prefetch" href="/assets/js/261.c9bbfff2.js"><link rel="prefetch" href="/assets/js/262.b591b778.js"><link rel="prefetch" href="/assets/js/263.e9103558.js"><link rel="prefetch" href="/assets/js/264.23f91e80.js"><link rel="prefetch" href="/assets/js/265.2530a5be.js"><link rel="prefetch" href="/assets/js/266.bebeceee.js"><link rel="prefetch" href="/assets/js/267.d39b9b05.js"><link rel="prefetch" href="/assets/js/268.f078ceca.js"><link rel="prefetch" href="/assets/js/269.5a4c98c3.js"><link rel="prefetch" href="/assets/js/27.4e49011a.js"><link rel="prefetch" href="/assets/js/270.07d7388b.js"><link rel="prefetch" href="/assets/js/271.ad4d1833.js"><link rel="prefetch" href="/assets/js/272.14c7f5b8.js"><link rel="prefetch" href="/assets/js/273.57293cae.js"><link rel="prefetch" href="/assets/js/274.64247ac8.js"><link rel="prefetch" href="/assets/js/275.85fa2e4f.js"><link rel="prefetch" href="/assets/js/276.6bd632fc.js"><link rel="prefetch" href="/assets/js/277.0b35c311.js"><link rel="prefetch" href="/assets/js/278.a170bd76.js"><link rel="prefetch" href="/assets/js/279.9f27bba3.js"><link rel="prefetch" href="/assets/js/28.44af85e1.js"><link rel="prefetch" href="/assets/js/280.fa55bae9.js"><link rel="prefetch" href="/assets/js/281.6d3d5428.js"><link rel="prefetch" href="/assets/js/282.71194641.js"><link rel="prefetch" href="/assets/js/283.9d4e9b49.js"><link rel="prefetch" href="/assets/js/284.4dd89978.js"><link rel="prefetch" href="/assets/js/285.21de6229.js"><link rel="prefetch" href="/assets/js/286.21cf0261.js"><link rel="prefetch" href="/assets/js/287.ce419f82.js"><link rel="prefetch" href="/assets/js/288.95a04fdb.js"><link rel="prefetch" href="/assets/js/289.ce6c099f.js"><link rel="prefetch" href="/assets/js/29.fc777276.js"><link rel="prefetch" href="/assets/js/290.39f33072.js"><link rel="prefetch" href="/assets/js/291.0a2076a6.js"><link rel="prefetch" href="/assets/js/292.22cb504d.js"><link rel="prefetch" href="/assets/js/293.2f1e8311.js"><link rel="prefetch" href="/assets/js/294.f7ad68d0.js"><link rel="prefetch" href="/assets/js/295.80181987.js"><link rel="prefetch" href="/assets/js/296.29248d5b.js"><link rel="prefetch" href="/assets/js/297.ac4a1950.js"><link rel="prefetch" href="/assets/js/298.5ad5e31e.js"><link rel="prefetch" href="/assets/js/299.cf68caa4.js"><link rel="prefetch" href="/assets/js/3.fcb4c17f.js"><link rel="prefetch" href="/assets/js/30.5f4b8b73.js"><link rel="prefetch" href="/assets/js/300.a02a02e6.js"><link rel="prefetch" href="/assets/js/301.9f2058d4.js"><link rel="prefetch" href="/assets/js/302.771ccbc7.js"><link rel="prefetch" href="/assets/js/303.804fbb18.js"><link rel="prefetch" href="/assets/js/304.abb664b7.js"><link rel="prefetch" href="/assets/js/305.b099f957.js"><link rel="prefetch" href="/assets/js/306.8c6f4146.js"><link rel="prefetch" href="/assets/js/307.7ad435d7.js"><link rel="prefetch" href="/assets/js/308.87370f5f.js"><link rel="prefetch" href="/assets/js/309.616b2c46.js"><link rel="prefetch" href="/assets/js/31.df6a598c.js"><link rel="prefetch" href="/assets/js/310.6ba4425a.js"><link rel="prefetch" href="/assets/js/311.9fee55f2.js"><link rel="prefetch" href="/assets/js/312.7792eb11.js"><link rel="prefetch" href="/assets/js/313.37ff195a.js"><link rel="prefetch" href="/assets/js/314.25a1c644.js"><link rel="prefetch" href="/assets/js/315.f85b2f9d.js"><link rel="prefetch" href="/assets/js/316.548ca6c4.js"><link rel="prefetch" href="/assets/js/317.719b58f8.js"><link rel="prefetch" href="/assets/js/318.5691e208.js"><link rel="prefetch" href="/assets/js/319.4086bb4e.js"><link rel="prefetch" href="/assets/js/32.a6c4d34a.js"><link rel="prefetch" href="/assets/js/320.ef2a4580.js"><link rel="prefetch" href="/assets/js/321.ed526c6b.js"><link rel="prefetch" href="/assets/js/322.acd5aef5.js"><link rel="prefetch" href="/assets/js/323.e641758e.js"><link rel="prefetch" href="/assets/js/324.0208f48d.js"><link rel="prefetch" href="/assets/js/325.68d3870b.js"><link rel="prefetch" href="/assets/js/326.258d5411.js"><link rel="prefetch" href="/assets/js/327.66ccc70d.js"><link rel="prefetch" href="/assets/js/328.aab280c1.js"><link rel="prefetch" href="/assets/js/329.25716d5f.js"><link rel="prefetch" href="/assets/js/33.0d5cf8cd.js"><link rel="prefetch" href="/assets/js/330.86f08d41.js"><link rel="prefetch" href="/assets/js/331.f47ca629.js"><link rel="prefetch" href="/assets/js/332.09292c80.js"><link rel="prefetch" href="/assets/js/333.e64921ea.js"><link rel="prefetch" href="/assets/js/334.257aa779.js"><link rel="prefetch" href="/assets/js/335.480dce2c.js"><link rel="prefetch" href="/assets/js/336.3fd455cb.js"><link rel="prefetch" href="/assets/js/337.da5376ab.js"><link rel="prefetch" href="/assets/js/338.ad8b28b0.js"><link rel="prefetch" href="/assets/js/339.9de60f43.js"><link rel="prefetch" href="/assets/js/34.78e3699e.js"><link rel="prefetch" href="/assets/js/340.b2999a74.js"><link rel="prefetch" href="/assets/js/341.cfa7fd9f.js"><link rel="prefetch" href="/assets/js/342.4a2f4a7d.js"><link rel="prefetch" href="/assets/js/343.7613e47d.js"><link rel="prefetch" href="/assets/js/344.6194fe94.js"><link rel="prefetch" href="/assets/js/345.b089f54e.js"><link rel="prefetch" href="/assets/js/346.095adec6.js"><link rel="prefetch" href="/assets/js/35.7b5d3c3f.js"><link rel="prefetch" href="/assets/js/36.6d8a3468.js"><link rel="prefetch" href="/assets/js/37.fc8700ee.js"><link rel="prefetch" href="/assets/js/38.3fd890cc.js"><link rel="prefetch" href="/assets/js/39.697aec0e.js"><link rel="prefetch" href="/assets/js/4.ecc69e2d.js"><link rel="prefetch" href="/assets/js/40.bf5c6367.js"><link rel="prefetch" href="/assets/js/41.2eec4d12.js"><link rel="prefetch" href="/assets/js/42.0036cfa8.js"><link rel="prefetch" href="/assets/js/43.4a87693f.js"><link rel="prefetch" href="/assets/js/44.f6483707.js"><link rel="prefetch" href="/assets/js/45.e62f85b6.js"><link rel="prefetch" href="/assets/js/46.29933817.js"><link rel="prefetch" href="/assets/js/47.7a214575.js"><link rel="prefetch" href="/assets/js/48.d8ff5362.js"><link rel="prefetch" href="/assets/js/49.e9bb9b73.js"><link rel="prefetch" href="/assets/js/5.0f3cf40b.js"><link rel="prefetch" href="/assets/js/50.20b47c17.js"><link rel="prefetch" href="/assets/js/51.88dca60e.js"><link rel="prefetch" href="/assets/js/52.0d8c3372.js"><link rel="prefetch" href="/assets/js/53.b10ba512.js"><link rel="prefetch" href="/assets/js/54.dba893fb.js"><link rel="prefetch" href="/assets/js/55.6f425752.js"><link rel="prefetch" href="/assets/js/56.02288926.js"><link rel="prefetch" href="/assets/js/57.acb91a30.js"><link rel="prefetch" href="/assets/js/58.d7b4d37f.js"><link rel="prefetch" href="/assets/js/59.575ebcb3.js"><link rel="prefetch" href="/assets/js/6.c6c91c34.js"><link rel="prefetch" href="/assets/js/60.afc2582a.js"><link rel="prefetch" href="/assets/js/61.bdeaa7d5.js"><link rel="prefetch" href="/assets/js/62.aeb1eb73.js"><link rel="prefetch" href="/assets/js/63.9d2549d3.js"><link rel="prefetch" href="/assets/js/64.522b561b.js"><link rel="prefetch" href="/assets/js/65.fb8c28e3.js"><link rel="prefetch" href="/assets/js/66.4a6c7b3a.js"><link rel="prefetch" href="/assets/js/67.2a4f8753.js"><link rel="prefetch" href="/assets/js/68.9f0a2e05.js"><link rel="prefetch" href="/assets/js/69.c4dfcdcc.js"><link rel="prefetch" href="/assets/js/7.3d50dad9.js"><link rel="prefetch" href="/assets/js/70.6a98ea31.js"><link rel="prefetch" href="/assets/js/71.a2e4d248.js"><link rel="prefetch" href="/assets/js/72.ed6cfea3.js"><link rel="prefetch" href="/assets/js/73.df175a59.js"><link rel="prefetch" href="/assets/js/74.f036648c.js"><link rel="prefetch" href="/assets/js/75.446aa8d1.js"><link rel="prefetch" href="/assets/js/76.6a8a6972.js"><link rel="prefetch" href="/assets/js/77.c27e08a1.js"><link rel="prefetch" href="/assets/js/78.ecd35ee6.js"><link rel="prefetch" href="/assets/js/79.d6da09cb.js"><link rel="prefetch" href="/assets/js/8.19d2d265.js"><link rel="prefetch" href="/assets/js/80.a63fa39d.js"><link rel="prefetch" href="/assets/js/81.900dad74.js"><link rel="prefetch" href="/assets/js/82.83cf7969.js"><link rel="prefetch" href="/assets/js/83.6e460306.js"><link rel="prefetch" href="/assets/js/84.8bfc75ce.js"><link rel="prefetch" href="/assets/js/85.ab9f22c4.js"><link rel="prefetch" href="/assets/js/86.9884d025.js"><link rel="prefetch" href="/assets/js/87.cb3a2cd3.js"><link rel="prefetch" href="/assets/js/88.3aac7774.js"><link rel="prefetch" href="/assets/js/89.2c05cf8e.js"><link rel="prefetch" href="/assets/js/9.c11c7729.js"><link rel="prefetch" href="/assets/js/90.859d2720.js"><link rel="prefetch" href="/assets/js/91.34462056.js"><link rel="prefetch" href="/assets/js/92.36466588.js"><link rel="prefetch" href="/assets/js/93.7aa7c3df.js"><link rel="prefetch" href="/assets/js/94.946bc11c.js"><link rel="prefetch" href="/assets/js/95.f931ec14.js"><link rel="prefetch" href="/assets/js/96.71b417db.js"><link rel="prefetch" href="/assets/js/97.fa50e29a.js"><link rel="prefetch" href="/assets/js/98.3f5d721d.js"><link rel="prefetch" href="/assets/js/99.22945055.js">
    <link rel="stylesheet" href="/assets/css/0.styles.002b7fb3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">全栈大前端</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="架构分析与设计" class="dropdown-title"><span class="title">架构分析与设计</span> <span class="arrow down"></span></button> <button type="button" aria-label="架构分析与设计" class="mobile-dropdown-title"><span class="title">架构分析与设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/m519w-RtdslHHrcbi_VLBA" target="_blank" rel="noopener noreferrer" class="nav-link external">
  框架设计：PC 端单页多页框架如何设计与落地 
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/Vtczty5i8awo3p7qspjhmg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  框架设计：RN 端的框架如何设计与落地
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/x4KcDPrV2aqtjkRdow_JVg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  透彻分析：常见的前端架构风格和案例
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/1kl8SV28GDt_40FF_6CuhA" target="_blank" rel="noopener noreferrer" class="nav-link external">
  领域驱动设计在前端中的应用
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/post/6844903853859536903" target="_blank" rel="noopener noreferrer" class="nav-link external">
  大型项目前端架构浅谈
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/26-算法/00-先导篇.html" class="nav-link">
  数据结构与算法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程思想与范式" class="dropdown-title"><span class="title">编程思想与范式</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程思想与范式" class="mobile-dropdown-title"><span class="title">编程思想与范式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.zoo.team/article/program-paradigm" target="_blank" rel="noopener noreferrer" class="nav-link external">
  编写高质量可维护的代码：编程范式
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://segmentfault.com/a/1190000018239556" target="_blank" rel="noopener noreferrer" class="nav-link external">
  面向对象之三个基本特征（javaScript）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://segmentfault.com/a/1190000020319171" target="_blank" rel="noopener noreferrer" class="nav-link external">
  面向对象之七大基本原则（javaScript）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.im/post/5c2e10a76fb9a049c0432697" target="_blank" rel="noopener noreferrer" class="nav-link external">
  设计模式与开发实践
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/ascoders/weekly/tree/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端精读-设计模式
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="跨端融合" class="dropdown-title"><span class="title">跨端融合</span> <span class="arrow down"></span></button> <button type="button" aria-label="跨端融合" class="mobile-dropdown-title"><span class="title">跨端融合</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://juejin.cn/post/6881597846307635214" target="_blank" rel="noopener noreferrer" class="nav-link external">
  深入浅出主流的几款小程序跨端框架原理
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/post/6893028483232956429" target="_blank" rel="noopener noreferrer" class="nav-link external">
  去哪儿网React Native 优先的多端统一化方案
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.electronjs.org/docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Electron
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://nervjs.github.io/taro/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Taro
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://uniapp.dcloud.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Uni-app
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://flutter.dev/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Flutter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://developer.mozilla.org/zh-CN/docs/Web/Progressive_web_apps" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PWA
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="低码平台" class="dropdown-title"><span class="title">低码平台</span> <span class="arrow down"></span></button> <button type="button" aria-label="低码平台" class="mobile-dropdown-title"><span class="title">低码平台</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://h5.dooring.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  H5-dooring
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于作者" class="dropdown-title"><span class="title">关于作者</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于作者" class="mobile-dropdown-title"><span class="title">关于作者</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/00-大纲.html" class="nav-link">
  简介
</a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/z4909801" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="架构分析与设计" class="dropdown-title"><span class="title">架构分析与设计</span> <span class="arrow down"></span></button> <button type="button" aria-label="架构分析与设计" class="mobile-dropdown-title"><span class="title">架构分析与设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/m519w-RtdslHHrcbi_VLBA" target="_blank" rel="noopener noreferrer" class="nav-link external">
  框架设计：PC 端单页多页框架如何设计与落地 
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/Vtczty5i8awo3p7qspjhmg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  框架设计：RN 端的框架如何设计与落地
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/x4KcDPrV2aqtjkRdow_JVg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  透彻分析：常见的前端架构风格和案例
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/1kl8SV28GDt_40FF_6CuhA" target="_blank" rel="noopener noreferrer" class="nav-link external">
  领域驱动设计在前端中的应用
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/post/6844903853859536903" target="_blank" rel="noopener noreferrer" class="nav-link external">
  大型项目前端架构浅谈
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/26-算法/00-先导篇.html" class="nav-link">
  数据结构与算法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程思想与范式" class="dropdown-title"><span class="title">编程思想与范式</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程思想与范式" class="mobile-dropdown-title"><span class="title">编程思想与范式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.zoo.team/article/program-paradigm" target="_blank" rel="noopener noreferrer" class="nav-link external">
  编写高质量可维护的代码：编程范式
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://segmentfault.com/a/1190000018239556" target="_blank" rel="noopener noreferrer" class="nav-link external">
  面向对象之三个基本特征（javaScript）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://segmentfault.com/a/1190000020319171" target="_blank" rel="noopener noreferrer" class="nav-link external">
  面向对象之七大基本原则（javaScript）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.im/post/5c2e10a76fb9a049c0432697" target="_blank" rel="noopener noreferrer" class="nav-link external">
  设计模式与开发实践
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/ascoders/weekly/tree/master/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端精读-设计模式
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="跨端融合" class="dropdown-title"><span class="title">跨端融合</span> <span class="arrow down"></span></button> <button type="button" aria-label="跨端融合" class="mobile-dropdown-title"><span class="title">跨端融合</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://juejin.cn/post/6881597846307635214" target="_blank" rel="noopener noreferrer" class="nav-link external">
  深入浅出主流的几款小程序跨端框架原理
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/post/6893028483232956429" target="_blank" rel="noopener noreferrer" class="nav-link external">
  去哪儿网React Native 优先的多端统一化方案
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.electronjs.org/docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Electron
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://nervjs.github.io/taro/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Taro
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://uniapp.dcloud.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Uni-app
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://flutter.dev/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Flutter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://developer.mozilla.org/zh-CN/docs/Web/Progressive_web_apps" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PWA
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="低码平台" class="dropdown-title"><span class="title">低码平台</span> <span class="arrow down"></span></button> <button type="button" aria-label="低码平台" class="mobile-dropdown-title"><span class="title">低码平台</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://h5.dooring.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  H5-dooring
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于作者" class="dropdown-title"><span class="title">关于作者</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于作者" class="mobile-dropdown-title"><span class="title">关于作者</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/00-大纲.html" class="nav-link">
  简介
</a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/z4909801" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">Home</a></li><li><a href="/00-大纲.html" class="sidebar-link">项目大纲</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java Script</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ECMA Script</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Type Script</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Html CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Browser</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Store</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Node</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/19-Node/00-Node基础.html" class="sidebar-link">Node基础</a></li><li><a href="/19-Node/01-Node多线程.html" class="sidebar-link">Node多线程</a></li><li><a href="/19-Node/01-Node多进程.html" class="sidebar-link">Node多进程与集群</a></li><li><a href="/19-Node/02-NodeServer.html" class="sidebar-link">NodeSever主流框架横评</a></li><li><a href="/19-Node/04-Egg.html" aria-current="page" class="active sidebar-link">NodeSever-Egg</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/19-Node/04-Egg.html#egg-基础全面讲解系列" class="sidebar-link">Egg-基础全面讲解系列</a></li><li class="sidebar-sub-header"><a href="/19-Node/04-Egg.html#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/19-Node/04-Egg.html#eggjs-基本使用" class="sidebar-link">Eggjs 基本使用</a></li><li class="sidebar-sub-header"><a href="/19-Node/04-Egg.html#eggjs-启动" class="sidebar-link">eggjs 启动</a></li><li class="sidebar-sub-header"><a href="/19-Node/04-Egg.html#egg-bin" class="sidebar-link">egg-bin</a></li><li class="sidebar-sub-header"><a href="/19-Node/04-Egg.html#egg-cluster" class="sidebar-link">egg-cluster</a></li><li class="sidebar-sub-header"><a href="/19-Node/04-Egg.html#egg-egg-core" class="sidebar-link">egg &amp;amp; egg-core</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/19-Node/04-Egg.html#eggapplication-egg-lib-egg-js" class="sidebar-link">EggApplication(egg/lib/egg.js)</a></li></ul></li><li class="sidebar-sub-header"><a href="/19-Node/04-Egg.html#思考" class="sidebar-link">思考:</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/19-Node/04-Egg.html#application-egg-lib-application-js" class="sidebar-link">Application(egg/lib/application.js)</a></li></ul></li><li class="sidebar-sub-header"><a href="/19-Node/04-Egg.html#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/19-Node/05-Nest.html" class="sidebar-link">NodeSever-Nest</a></li><li><a href="/19-Node/06-Node性能优化.html" class="sidebar-link">Node性能优化</a></li><li><a href="/19-Node/07-Node性能监控.html" class="sidebar-link">Node性能监控</a></li><li><a href="/19-Node/08-Node服务治理.html" class="sidebar-link">Node服务治理</a></li><li><a href="/19-Node/99-Node问题集锦.html" class="sidebar-link">Node问题集锦</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SSR</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Electron</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Hybrid</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>跨端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Dev Ops</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Server</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端编译</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>小程序</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>微前端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>性能优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>监控体系</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>手写</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>编码规范</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>架构设计</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>综合扩展</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>学习提升</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="egg-基础全面讲解系列"><a href="#egg-基础全面讲解系列" class="header-anchor">#</a> Egg-基础全面讲解系列</h2> <ul><li>一文看懂 Eggjs-基础全面讲解（上） <a href="https://juejin.im/post/5d357f0e51882563914b49bb" target="_blank" rel="noopener noreferrer">https://juejin.im/post/5d357f0e51882563914b49bb<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>一文看懂 Eggjs-基础全面讲解（中） <a href="https://juejin.im/post/5d36679ce51d45554877a6ab" target="_blank" rel="noopener noreferrer">https://juejin.im/post/5d36679ce51d45554877a6ab<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>一文看懂 Eggjs-基础全面讲解（下） <a href="https://juejin.im/post/5d37ba17f265da1bc94f2f97" target="_blank" rel="noopener noreferrer">https://juejin.im/post/5d37ba17f265da1bc94f2f97<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>一文看懂 Eggjs-基础全面讲解（完结） <a href="https://juejin.im/post/5d38160c51882551c37fbcd2" target="_blank" rel="noopener noreferrer">https://juejin.im/post/5d38160c51882551c37fbcd2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>前端时间抽出时间针对<a href="https://github.com/koajs/koa" target="_blank" rel="noopener noreferrer">Koa2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>源码进行了简单的学习，<strong>koa</strong> 源码是一个很简单的库， 针对分析过程， 想手把手的实现一个类型<strong>koa</strong> 的框架，其<a href="https://github.com/bluebrid/koa-learning" target="_blank" rel="noopener noreferrer">代码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, 根据一步步的完善实现一个简单版本的 Koa, 每一个步骤一个<strong>Branch</strong> ， 如： <a href="https://github.com/bluebrid/koa-learning/tree/step-1" target="_blank" rel="noopener noreferrer">stpe-1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, 对应的是我想实现第一步的代码， 代码仅供自己简单的学习，很多地方不完善，只是想体验下 Koa 的思想。下面几点是我对 Koa 的简单理解:</p> <blockquote><ul><li>所有的 NodeJS 框架最基本的核心就是通过原生库<code>http</code> or <code>https</code>启动一个后端服务<code>http.createServer(this.serverCallBack()).listen(...arg)</code>， 然后所有的请求都会进入<code>serverCallBack</code>方法， 然后我们可以通过拦截，在这个方法中处理不同的请求</li> <li>Koa 是一个洋葱模型， 其是基于中间件来实现的.通过<code>use</code>来添加一个中间件， <code>koa-router</code>其实就是一个<code>koa</code>的中间件，我们的所有的请求都会将所有的中间件都执行一遍，洋葱模型如下图所示</li></ul></blockquote> <p><img src="https://user-gold-cdn.xitu.io/2018/11/12/16706e6c0db63bd6?imageView2/0/w/1280/h/960/ignore-error/1" alt=""> <img src="https://user-gold-cdn.xitu.io/2018/11/12/16706e706333f9eb?imageView2/0/w/1280/h/960/ignore-error/1" alt=""></p> <p>上面是我对 Koa 源码分析的一些简单的理解， 后面我会将对 Koa 的理解，进一步的记录下来。 Koa 是一个很小巧灵活的框架， 不像 Express, Express 已经集成了很多的功能， 很多功能不再需要第三方的框架，比如说路由功能， Koa 需要引用第三方的库 koa-router 来实现路由等。但是 express 则不需要，下面是 Koa 和 Express, 两个实现一个简单的功能的 Demo , 我们可以比较下其使用方式：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token comment">// Express</span>
    <span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'express'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'/'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-keyword&quot;</span><span class="token operator">&gt;</span><span class="token keyword">function</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'Hello World!'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-function&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-title&quot;</span><span class="token operator">&gt;</span><span class="token keyword">function</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'Example app listening on port 3000!'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;copy-code-btn&quot;</span><span class="token operator">&gt;</span>复制代码<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;/pre&gt;&lt;pre&gt;</span><span class="token template-punctuation string">`</span></span><span class="token comment">// Koa</span>
    <span class="token keyword">var</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'koa'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 引用第三方路由库</span>
    <span class="token keyword">var</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'koa-router'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'/'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&amp;</span>gt<span class="token punctuation">;</span> <span class="token punctuation">{</span>
      <span class="token comment">// ctx.router available</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 应用中间件： router</span>
    app
      <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;copy-code-btn&quot;</span><span class="token operator">&gt;</span>复制代码<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>`<span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>哈哈，我们上面说了很多的废话(文字表达能力问题)， 其实我是想分析下，怎么基于 Koa 框架去应用， <a href="https://github.com/eggjs/egg" target="_blank" rel="noopener noreferrer">eggjs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>就是基于 Koa 框架基础上实现的一个框架， 我们下面来具体分析下<strong>eggjs</strong> 框架。</p> <h2 id="eggjs-基本使用"><a href="#eggjs-基本使用" class="header-anchor">#</a> Eggjs 基本使用</h2> <p>我们根据<a href="https://eggjs.org/zh-cn/intro/quickstart.html" target="_blank" rel="noopener noreferrer">快速入门<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, 可以很快搭建一个 Egg 项目框架，</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span>
  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">$ npm i egg-init -g $ egg-init egg-example --type=simple </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token string">&quot; &quot;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
  &lt;span class=&quot;hljs-built_in&quot;&gt;cd&lt;/span&gt; egg-example $ npm i
  &lt;span class=&quot;copy-code-btn&quot;&gt;复制代码&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>我们可以用<code>npm run dev</code> 快速启动项目.然后打开<code>localhost:7001</code>,就可以看到页面输出：</p> <p>hi, egg.</p> <p>说明我们项目初始化已经完成，而且已经启动成功。我们现在可以学习下 egg 项目生成的相关代码。其代码文件结构如下:</p> <p><img src="https://user-gold-cdn.xitu.io/2018/11/12/167071dfb2cd29f5?imageView2/0/w/1280/h/960/ignore-error/1" alt=""></p> <p>分析整个文件结构，找了整个项目都没有发现 app.js 之类的入口文件(我一般学习一个新的框架，都会从入口文件着手), 发现<strong>app</strong> 文件夹下面的应该对项目很重要的代码：</p> <blockquote><p>1, controller 文件夹，我们从字面理解，应该是控制层的文件，其中有一个 home.js 代码如下:</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'use strict'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> Controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'egg'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Controller<span class="token punctuation">;</span>

    <span class="token keyword">class</span> <span class="token class-name">HomeController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>
      async <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-function&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-title&quot;</span><span class="token operator">&gt;</span>index<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'hi, egg'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    module<span class="token punctuation">.</span>exports <span class="token operator">=</span> HomeController<span class="token punctuation">;</span>

    <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;copy-code-btn&quot;</span><span class="token operator">&gt;</span>复制代码<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>这个类继承了 egg 的 Controller 类, 暂时还没有发现这个项目哪个地方有引用这个<strong>Controller</strong> 类?</p> <blockquote><p>2, 一个<strong>router.js</strong> 文件， 从字面意义上我们可以理解其为一个路由的文件，其代码如下:</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;span class=&quot;hljs-string&quot;&gt;'use strict'&lt;/span&gt;;

    /**
     * @param {Egg.Application} app - egg application
     */
    module.exports = app =&amp;gt; {
      const { router, controller } = app;
      router.get(&lt;span class=&quot;hljs-string&quot;&gt;'/'&lt;/span&gt;, controller.home.index);
    };

    &lt;span class=&quot;copy-code-btn&quot;&gt;复制代码&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>这个文件暴露了一个方法， 从目前来猜测应该就是路由的一些配置， 但是找遍整个项目也没有发现，哪个地方引用了这个方法，
<code>router.get('/', controller.home.index);</code>, 但是从这个 get 方法的第二个参数， 其似乎指向的是 Controller 里面的 home.js 文件 index 方法，我们可以尝试修改下 home.js 中的<code>this.ctx.body = 'hi, egg -&amp;gt; hello world!';</code>, 然后重新运行<code>npm run dev</code>, 发现页面输出是<code>hi, egg -&amp;gt; hello world!</code>, 看来<code>controller.home.index</code>这个指向的是 home.js 里的 index 方法无疑了， 但是<code>controller.home.index</code>这个 index 方法绑定的是在一个<code>controller</code>对象上，什么时候绑定的呢?</p> <p>我们接下来带着如下疑问来学些<strong>eggjs</strong> :</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token operator">&gt;</span> <span class="token operator">*</span>   <span class="token operator">&lt;</span>font color<span class="token operator">=</span><span class="token string">&quot;red&quot;</span><span class="token operator">&gt;</span>没有类似的app<span class="token punctuation">.</span>js 入口文件，运行<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">npm run dev</span><span class="token template-punctuation string">`</span></span> <span class="token function">如何启动一个项目</span><span class="token punctuation">(</span>启动server<span class="token punctuation">,</span> 监听端口， 添加中间件<span class="token punctuation">)</span><span class="token operator">?</span><span class="token operator">&lt;</span><span class="token operator">/</span>font<span class="token operator">&gt;</span>
    <span class="token operator">&gt;</span> <span class="token operator">*</span>   <span class="token operator">&lt;</span>font color<span class="token operator">=</span><span class="token string">&quot;red&quot;</span><span class="token operator">&gt;</span>我们打开页面<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://localhost:7001/</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>怎么去通过router<span class="token punctuation">.</span>js 去查找路由的，然后调用对应的回调函数<span class="token operator">?</span><span class="token operator">&lt;</span><span class="token operator">/</span>font<span class="token operator">&gt;</span>
    <span class="token operator">&gt;</span> <span class="token operator">*</span>   <span class="token operator">&lt;</span>font color<span class="token operator">=</span><span class="token string">&quot;red&quot;</span><span class="token operator">&gt;</span>Controller 是如何绑定到app 上面的controller 对象上的<span class="token operator">?</span><span class="token operator">&lt;</span><span class="token operator">/</span>font<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="eggjs-启动"><a href="#eggjs-启动" class="header-anchor">#</a> eggjs 启动</h2> <p>我们先查看一开始用<code>egg-init</code>命令创建的项目的 package.json 文件,查看<code>scripts</code>，里面有一系列的命令，如下图:</p> <figure>![](https://user-gold-cdn.xitu.io/2018/11/15/167165ee63bce475?imageView2/0/w/1280/h/960/ignore-error/1)
我们可以通过`npm run start`来启动程序， 但是其中有一个命令`debug`, 我们可以可以通过`npm run debug`命令来调试eggjs 程序， 其对用的命令是`egg-bin debug`, 所以我们整个入口就是这个命令，我们下面来具体分析下`egg-bin debug`是如何工作的.
<h2 id="egg-bin"><a href="#egg-bin" class="header-anchor">#</a> egg-bin</h2> <p>egg-bin 中的<code>start-cluster</code>文件， 调用了 eggjs 的入口方法：<code>require(options.framework).startCluster(options);</code>
其中 options.framework 指向的就是一个绝对路径<code>D:\private\your_project_name\node_modules\egg</code>(也就是<strong>egg</strong> 模块), 直接执行<code>D:\private\your_project_name\node_modules\egg\index.js</code>暴露出来的<code>exports.startCluster = require('egg-cluster').startCluster;</code> 的<code>startCluster</code>方法。 下面我们就来分析<strong>egg-cluster</strong> 模块。</p> <h2 id="egg-cluster"><a href="#egg-cluster" class="header-anchor">#</a> egg-cluster</h2> <p>egg-cluster 的项目结构如下， 其中有两个主要的文件： <code>master.js</code>, <code>app_worker.js</code>两个文件，</p> <p><img src="https://user-gold-cdn.xitu.io/2018/11/16/1671aa8306a9216a?imageView2/0/w/1280/h/960/ignore-error/1" alt=""> <code>master.js</code>是跟 nodejs 的多线程有关，我们先跳过这一块，直接研究<code>app_worker.js</code>文件，学习 eggjs 的启动过程。下面我们就是 app_worker.js 执行的主要步骤。</p> <ul><li><ol><li><code>const Application = require(options.framework).Application;</code> , 引入 eggjs 模块， optons.framework 指向的就是<code>D:\private\your_project_name\node_modules\egg</code></li></ol></li> <li><ol start="2"><li><code>const app = new Application(options);</code>(创建一个 egg 实例)</li></ol></li> <li><ol start="3"><li><p><code>app.ready(startServer);</code>调用 egg 对象的** ready ** 方法，其 startServer 是一个回调函数，其功能是调用 nodejs 原生模块<code>http</code> or <code>https</code> 的 <code>createServer</code> 创建一个 nodejs 服务(<code>server = require('http').createServer(app.callback());</code>, 我们后续会深入分析这个方法)。
上面三个步骤， 已经启动了一个 nodejs 服务， 监听了端口。也就是已经解决了我们的第一个疑问:</p> <div class="language- extra-class"><pre><code>&gt; &lt;font color=&quot;red&quot;&gt; 没有类似的 app.js 入口文件，运行 npm run dev 如何启动一个项目(启动 server, 监听端口， 添加中间件)?&lt;/font&gt;

上面其实我们还是只是分析了 eggjs 启动的基本流程， 还没有涉及 eggjs 的核心功能库，也就是** egg ** 和** egg-core** 两个库，但是我们上面已经初实例化了一个 eggjs 的对象`const app = new Application(options);`, 下面我们就从这个入口文件来分析 eggjs 的核心模块。
</code></pre></div></li></ol> <h2 id="egg-egg-core"><a href="#egg-egg-core" class="header-anchor">#</a> egg &amp; egg-core</h2> <p>egg 和 egg-core 模块下面有几个核心的类，如下:</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token function">Application</span><span class="token punctuation">(</span>egg<span class="token operator">/</span>lib<span class="token operator">/</span>applicaton<span class="token punctuation">.</span>js<span class="token punctuation">)</span> <span class="token operator">&lt;</span>font color<span class="token operator">=</span><span class="token string">&quot;red&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;5&quot;</span><span class="token operator">&gt;</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">&amp;</span>gt<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>font<span class="token operator">&gt;</span> <span class="token function">EggApplication</span><span class="token punctuation">(</span>egg<span class="token operator">/</span>lib<span class="token operator">/</span>egg<span class="token punctuation">.</span>js<span class="token punctuation">)</span> <span class="token operator">&lt;</span>font color<span class="token operator">=</span><span class="token string">&quot;red&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;5&quot;</span><span class="token operator">&gt;</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">&amp;</span>gt<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>font<span class="token operator">&gt;</span> <span class="token function">EggCore</span><span class="token punctuation">(</span>egg<span class="token operator">-</span>core<span class="token operator">/</span>lib<span class="token operator">/</span>egg<span class="token punctuation">.</span>js<span class="token punctuation">)</span> <span class="token operator">&lt;</span>font color<span class="token operator">=</span><span class="token string">&quot;red&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;5&quot;</span><span class="token operator">&gt;</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">&amp;</span>gt<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>font<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>font size<span class="token operator">=</span><span class="token string">&quot;5&quot;</span><span class="token operator">&gt;</span> <span class="token function">KoaApplication</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>font color<span class="token operator">=</span><span class="token string">&quot;red&quot;</span><span class="token operator">&gt;</span>koa<span class="token operator">&lt;</span><span class="token operator">/</span>font<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>font<span class="token operator">&gt;</span>

    从上面的关系可以，eggjs 是基于<span class="token operator">**</span>koa<span class="token operator">**</span><span class="token function">的基础上进行扩展的，所以我们从基类的构造函数开始进行分析</span><span class="token punctuation">(</span>因为 <span class="token keyword">new</span> <span class="token class-name">Application</span> 会从继类开始的构造函数开始执行<span class="token punctuation">)</span>。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- extra-class"><pre><code>### EggCore(egg-core/lib/egg.js)
</code></pre></div><p>我们将构造函数进行精简，代码如下
<img src="https://user-gold-cdn.xitu.io/2018/11/16/1671b43d9083e9d2?imageView2/0/w/1280/h/960/ignore-error/1" alt="">从上图可知，构造函数就是初始化了很多基础的属性，其中有两个属性很重要：</p> <blockquote><ol><li><code>this.lifecycle</code>负责整个 eggjs 实例的生命周期，我们后续会深入分析整个生命周期</li> <li><code>this.loader</code>(egg-core/lib/loader/egg_loader.js)解决了 eggjs 为什么在服务启动后，会自动加载，将项目路径下的<code>router.js</code>, <code>controller/**.js</code>, 以及<code>service/**.js</code>绑定到 <code>app</code> 实例上， 我们接下来会重点分析这个 loader.</li></ol></blockquote> <h3 id="eggapplication-egg-lib-egg-js"><a href="#eggapplication-egg-lib-egg-js" class="header-anchor">#</a> EggApplication(egg/lib/egg.js)</h3> <p>我们将构造函数进行精简，代码如下</p> <p><img src="https://user-gold-cdn.xitu.io/2018/11/16/1671b4fde0678d85?imageView2/0/w/1280/h/960/ignore-error/1" alt=""></p> <p>这个构造函数同样也是初始化了很多基础的属性， 但是其中有调用<strong>EggCore</strong> 构造函数初始化的<strong>loader</strong> 的<code>loadConfig()</code> 方法, 这个方法顾名思义就是去加载配置，其指向的是: <code>egg/lib/loader/app_worker_loader .js</code> 的方法<code>loadConfig</code> , 这个方法，如下:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
    <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-title&quot;&gt;loadConfig&lt;/span&gt;&lt;/span&gt;() {
        this.loadPlugin();
        super.loadConfig();
      }

    &lt;span class=&quot;copy-code-btn&quot;&gt;复制代码&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>

    其会加载所有的 Plugin <span class="token punctuation">,</span>然后就加载所有的 Config<span class="token punctuation">.</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 指向的是<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">egg-core/lib/loader/mixin/plgin.js</span><span class="token template-punctuation string">`</span></span>的方法<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">loadPlugin</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> 其会加载三种 plugin<span class="token operator">:</span>

<span class="token operator">-</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">const appPlugins = this.readPluginConfigs(path.join(this.options.baseDir, 'config/plugin.default'));</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>应用配置的 plugin <span class="token punctuation">,</span> 也就是<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">your-project-name/config/plugin.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> 也就是每个应用需要配置的特殊的插件
<span class="token operator">-</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">const eggPluginConfigPaths = this.eggPaths.map(eggPath =&amp;gt; path.join(eggPath, 'config/plugin.default'));</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> 也就是从 eggjs 框架配置的插件， 其路径是在<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">egg/config/plugin.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> 也就是框架自带的插件
<span class="token operator">-</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">process.env.EGG_PLUGINS</span><span class="token template-punctuation string">`</span></span> 第三种， 是启动项目是，命令行带参数<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">EGG_PLUGINS</span><span class="token template-punctuation string">`</span></span>的插件， 应该使用不广。

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>最后将所有的 plugin 挂在在 app 实例上<code>this.plugins = enablePlugins;</code>,。(后续会学习怎么这些 plugin 怎么工作的。)</p> <p>接下来会执行<code>super.loadConfig()</code>方法， 其指向的是<code>egg-core/lib/loader/mixin/config.js</code>的<code>loadConfig()</code>方法，
其同样会加载四种 config:</p> <ul><li><code>const appConfig = this._preloadAppConfig();</code>, 应用配置的 config , 也就是每个应用的特殊配置，其会加载两个配置:</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  const names = [
       &lt;span class=&quot;hljs-string&quot;&gt;'config.default'&lt;/span&gt;,
       </span><span class="token template-punctuation string">`</span></span>config<span class="token punctuation">.</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-variable&quot;</span><span class="token operator">&gt;</span>$<span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>serverEnv<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">,
     ];
  &lt;span class=&quot;copy-code-btn&quot;&gt;复制代码&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>

  第一个一定会加载对应的<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">config.default</span><span class="token template-punctuation string">`</span></span>配置， 也就是<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">your-project-name/config/config.default.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>跟运行环境没有关系的配置， 其次会加载跟运行环境有关的配置，如： <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">config.prod.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">config.test.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">config.local.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">config.unittest.js</span><span class="token template-punctuation string">`</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>会去加载所有的 plugin 插件目录</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
  <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">   &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (this.orderPlugins) {
       &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (const plugin of this.orderPlugins) {
         dirs.push({
           path: plugin.path,
           &lt;span class=&quot;hljs-built_in&quot;&gt;type&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;'plugin'&lt;/span&gt;,
         });
       }
     }
  &lt;span class=&quot;copy-code-btn&quot;&gt;复制代码&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>会去加载 egg 项目目录, 也就是 egg/config 目录</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (const eggPath of this.eggPaths) {
       dirs.push({
         path: eggPath,
         &lt;span class=&quot;hljs-built_in&quot;&gt;type&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;'framework'&lt;/span&gt;,
       });
     }
  &lt;span class=&quot;copy-code-btn&quot;&gt;复制代码&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><p>回去加载应用项目的目录， 也就是也就是<code>your-project-name/config</code></p> <p>最后将合并的 config 挂载在 app 实例上<code>this.config = target;</code></p> <p>我们可以打开<code>egg/config/config.default.js</code>文件，可以查看下，默认的都有什么配置，其中一个配置如下：</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>config<span class="token punctuation">.</span>cluster <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">listen</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">''</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">7001</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hostname</span><span class="token operator">:</span> <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">''</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;copy-code-btn&quot;</span><span class="token operator">&gt;</span>复制代码<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>很明显，这应该是一个对 server 启动的配置，我们暂且可以这样猜测。</p> <p>我们上面有分析在<code>egg-cluster/lib/app_worker.js</code>中，我们初始化<strong>app</strong> 后，我们有调用<code>app.ready(startServer);</code>方法，我们可以猜测<code>startServer</code>方法就是启动 nodejs server 的地方。</p> <p>在<code>startServer</code>方法中，初始化了一个 http server <code>server = require('http').createServer(app.callback());</code>, 然后我们给 listen <code>server.listen(...args);;</code>, 这样算是 node js 的 server 启动起来了， 我们可以查看下，我可以查看 args 的参数：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token punctuation">[</span> port <span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-keyword&quot;</span><span class="token operator">&gt;</span><span class="token keyword">if</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span> <span class="token punctuation">(</span>listenConfig<span class="token punctuation">.</span>hostname<span class="token punctuation">)</span> args<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>listenConfig<span class="token punctuation">.</span>hostname<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">debug</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'listen options %s'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;copy-code-btn&quot;</span><span class="token operator">&gt;</span>复制代码<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这里给 args 添加了 prot 端口参数， 我们可以跳转到 prot 定义的地方：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Application</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> clusterConfig <span class="token operator">=</span> app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>cluster <span class="token operator">||</span> <span class="token comment">/* istanbul ignore next */</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> listenConfig <span class="token operator">=</span> clusterConfig<span class="token punctuation">.</span>listen <span class="token operator">||</span> <span class="token comment">/* istanbul ignore next */</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> port <span class="token operator">=</span> options<span class="token punctuation">.</span>port <span class="token operator">=</span> options<span class="token punctuation">.</span>port <span class="token operator">||</span> listenConfig<span class="token punctuation">.</span>port<span class="token punctuation">;</span>
  <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;copy-code-btn&quot;</span><span class="token operator">&gt;</span>复制代码<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>

我们可以看到 port 最终来源于： <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">app.config.cluster.listen.port</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>从这里我们得知， eggjs 的 config 的使用方式。

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong><font color="red"> 问题:</font></strong></p> <p>如果我们不想在 eggjs 项目启动时，默认打开的端口不是<strong>7001</strong> ，我们改怎么操作呢？</p> <p>我们应该有如下两种方式：</p> <ol><li>在执行 npm run debug 命令时，添加相应的参数</li> <li>我们可以在我们项目的 config/config.default.js 中添加配置，将默认的给覆盖掉，如：</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    module<span class="token punctuation">.</span>exports <span class="token operator">=</span> appInfo <span class="token operator">=</span><span class="token operator">&amp;</span>gt<span class="token punctuation">;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> config <span class="token operator">=</span> exports <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

      <span class="token comment">// use &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; cookie sign key, should change to your own and keep security</span>
      config<span class="token punctuation">.</span>keys <span class="token operator">=</span> appInfo<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'_1541735701381_1116'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">;</span>

      <span class="token comment">// add your config here</span>
      config<span class="token punctuation">.</span>middleware <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      config<span class="token punctuation">.</span>cluster <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">listen</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">''</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">7788</span><span class="token punctuation">,</span>
          <span class="token literal-property property">hostname</span><span class="token operator">:</span> <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">''</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-built_in&quot;</span><span class="token operator">&gt;</span><span class="token keyword">return</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span> config<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;copy-code-btn&quot;</span><span class="token operator">&gt;</span>复制代码<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>如上，我们再次启动项目的时候，打开的端口就是： 7788 了。</p> <h2 id="思考"><a href="#思考" class="header-anchor">#</a> 思考:</h2> <p>我们已经知道可以在 config 中进行相应的配置了， 我们还有什么其他的应用在 config 上面呢？
我们知道在不同的运行环境下，会加载不同的配置，那如果我们在开发的时候，调用 api 的路径是： <code>http://dev.api.com</code>, 但是在上线的时候，我们调用的 app 的路径是： <code>http://prod.api.com</code>, 我们就可以在
<code>config.prod.js</code>中配置 <code>apiURL:http://prod.api.com</code>， 在<code>config.local.js</code>配置： <code>apiURL:http://prod.api.com</code>
然后我们在我们调用 API 的地方通过 <code>app.apiURL</code>就可以。</p> <h3 id="application-egg-lib-application-js"><a href="#application-egg-lib-application-js" class="header-anchor">#</a> Application(egg/lib/application.js)</h3> <div class="language- extra-class"><pre><code>Application(egg/lib/applicaton.js) &lt;font color=&quot;red&quot; size=&quot;5&quot;&gt;-----&amp;gt;&lt;/font&gt; EggApplication(egg/lib/egg.js) &lt;font color=&quot;red&quot; size=&quot;5&quot;&gt;-----&amp;gt;&lt;/font&gt; EggCore(egg-core/lib/egg.js) &lt;font color=&quot;red&quot; size=&quot;5&quot;&gt;-----&amp;gt;&lt;/font&gt; &lt;font size=&quot;5&quot;&gt; KoaApplication(&lt;font color=&quot;red&quot;&gt;koa&lt;/font&gt;)&lt;/font&gt;
</code></pre></div><p>我们已经将上述的两个核心的类： EggApplication(egg/lib/egg.js) <font color="red" size="5">-----&gt;</font> EggCore(egg-core/lib/egg.js)， 我们现在来分析最上层的类： Application(egg/lib/applicaton.js)。
我们还是从构造函数入手，我们发现了一行很重要的代码<code>this.loader.load();</code>其指向的是： <strong>app_worker_loader.js</strong>(egg/lib/loader/app_worker_loader.js)的 load 方法， 其实现如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-function&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-title&quot;</span><span class="token operator">&gt;</span>load<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// app &amp;gt; plugin &amp;gt; core</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadApplicationExtend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadRequestExtend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadResponseExtend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadContextExtend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadHelperExtend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// app &amp;gt; plugin</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadCustomApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// app &amp;gt; plugin</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// app &amp;gt; plugin &amp;gt; core</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// app</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// app</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Dependent on controllers</span>
      <span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;copy-code-btn&quot;</span><span class="token operator">&gt;</span>复制代码<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>`<span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>

    从这个方法可知，加载了一大批的配置，我们可以进行一一的分析：

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h4 id="this-loadapplicationextend"><a href="#this-loadapplicationextend" class="header-anchor">#</a> <code>this.loadApplicationExtend();</code></h4> <p>这个方法会去给应用加载很多的扩展方法， 其加载的路径是： app\extend\application.js, 会将对应的对象挂载在 app 应用上。 (使用方法可以参考 egg-jsonp/app/extend/applicaton.js 或者 egg-session/app/extend/application.js)</p> <h4 id="this-loadresponseextend-this-loadresponseextend-this-loadcontextextend-this-loadhelperextend"><a href="#this-loadresponseextend-this-loadresponseextend-this-loadcontextextend-this-loadhelperextend" class="header-anchor">#</a> <code>this.loadResponseExtend();</code> <code>this.loadResponseExtend();</code> <code>this.loadContextExtend();</code> <code>this.loadHelperExtend();</code>,</h4> <div class="language- extra-class"><pre><code>跟`this.loadApplicationExtend();`加载的方式是一样的，只是对应的名称分别是： request.js， response.js， helper.js， context.js

#### `this.loadCustomApp();`

定制化应用， 加载的文件是对应项目下的 app.js (your_project_name/app.js)， 其具体的代码实现如下: (egg-core/lib/loader/mixin/custom.js)
</code></pre></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>
    <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  [LOAD_BOOT_HOOK](fileName) {
        this.timing.start(</span><span class="token template-punctuation string">`</span></span>Load <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-variable&quot;</span><span class="token operator">&gt;</span>$<span class="token punctuation">{</span>fileName<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">.</span>js<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">);
        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (const unit of this.getLoadUnits()) {
          const bootFilePath = this.resolveModule(path.join(unit.path, fileName));
          &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!bootFilePath) {
            &lt;span class=&quot;hljs-built_in&quot;&gt;continue&lt;/span&gt;;
          }
          const bootHook = this.requireFile(bootFilePath);
          // bootHook 是加载的文件
          &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (is.class(bootHook)) {
            // &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; is boot class, add to lifecycle
            this.lifecycle.addBootHook(bootHook);
          } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (is.function(bootHook)) {
            // &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; is boot &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;, wrap to class
            // &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; compatibility
            this.lifecycle.addFunctionAsBootHook(bootHook);
          } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {
            this.options.logger.warn(&lt;span class=&quot;hljs-string&quot;&gt;'[egg-loader] %s must exports a boot class'&lt;/span&gt;, bootFilePath);
          }
        }
        // init boots
        this.lifecycle.init();
        this.timing.end(</span><span class="token template-punctuation string">`</span></span>Load <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-variable&quot;</span><span class="token operator">&gt;</span>$<span class="token punctuation">{</span>fileName<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">.</span>js<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">);
      },
    &lt;span class=&quot;copy-code-btn&quot;&gt;复制代码&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>从上可知** bootHook** 对应的就是加载的文件，从上面的<code>if</code> <code>else</code>可知， app.js 必须暴露出来的是一个<strong>class</strong> 或者是一个<strong>function</strong> ,然后调用<code>this.lifecycle.addFunctionAsBootHook(bootHook);</code>, 其代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
     <span class="token function">addFunctionAsBootHook</span><span class="token punctuation">(</span><span class="token parameter">hook</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">assert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">INIT</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-literal&quot;</span><span class="token operator">&gt;</span><span class="token boolean">false</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'do not add hook when lifecycle has been initialized'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// app.js is &lt;span class=&quot;hljs-built_in&quot;&gt;export&lt;/span&gt; as a funciton</span>
        <span class="token comment">// call this &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; configDidLoad</span>
        <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">BOOT_HOOKS</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">class</span> <span class="token class-name">Hook</span> <span class="token punctuation">{</span>
          <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>app <span class="token operator">=</span> app<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-function&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-title&quot;</span><span class="token operator">&gt;</span>configDidLoad<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">hook</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;copy-code-btn&quot;</span><span class="token operator">&gt;</span>复制代码<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language- extra-class"><pre><code>将对应的 hook push 到 this.lifecycle 的**BOOT_HOOKS** 数组中， 并且包装成了一个类， 且在**configDidLoad** 调用对应的 hook.然后调用了`this.lifecycle.init();`去初始化生命周期:
</code></pre></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>
    <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-function&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-title&quot;</span><span class="token operator">&gt;</span>init<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">assert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">INIT</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-literal&quot;</span><span class="token operator">&gt;</span><span class="token boolean">false</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'lifecycle have been init'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">INIT</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-literal&quot;</span><span class="token operator">&gt;</span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">BOOTS</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">BOOT_HOOKS</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>t <span class="token operator">=</span><span class="token operator">&amp;</span>gt<span class="token punctuation">;</span> <span class="token keyword">new</span> <span class="token class-name">t</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">REGISTER_BEFORE_CLOSE</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;copy-code-btn&quot;</span><span class="token operator">&gt;</span>复制代码<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>这个<strong>init</strong> 方法做了三件事情：</p> <ul><li>将 lifecycle 的 INIT 状态标记为： true</li> <li>将 BOOT_HOOKS 对应的类， 实例化一个对象，保存在<strong>BOOTS</strong> 上</li> <li>调用 REGISTER_BEFORE_CLOSE 方法，其中会调用我们的 hook 的<strong>beforeClose</strong> 方法。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">this.loadCustomApp();</span><span class="token template-punctuation string">`</span></span> 方法如下：

  <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-title&quot;&gt;loadCustomApp&lt;/span&gt;&lt;/span&gt;() {
      this[LOAD_BOOT_HOOK](&lt;span class=&quot;hljs-string&quot;&gt;'app'&lt;/span&gt;);
      this.lifecycle.triggerConfigWillLoad();
    },
  &lt;span class=&quot;copy-code-btn&quot;&gt;复制代码&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>所以接下执行<code>this.lifecycle.triggerConfigWillLoad();</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-title&quot;&gt;triggerConfigWillLoad&lt;/span&gt;&lt;/span&gt;() {
      &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (const boot of this[BOOTS]) {
        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (boot.configWillLoad) {
          boot.configWillLoad();
        }
      }
      this.triggerConfigDidLoad();
    }

    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-title&quot;&gt;triggerConfigDidLoad&lt;/span&gt;&lt;/span&gt;() {
      &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (const boot of this[BOOTS]) {
        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (boot.configDidLoad) {
          boot.configDidLoad();
        }
      }
      this.triggerDidLoad();
    }
  &lt;span class=&quot;copy-code-btn&quot;&gt;复制代码&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>其中<code>boot.configDidLoad();</code> 就是我们 app.js 定义的 hook, 被加工成的 Hook 类：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">class Hook {
        constructor(app) {
          this.app = app;
        }
        &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-title&quot;&gt;configDidLoad&lt;/span&gt;&lt;/span&gt;() {
          hook(this.app);
        }
      }
  &lt;span class=&quot;copy-code-btn&quot;&gt;复制代码&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>然后就将 app.js 与 eggjs 关联起来了。</p> <h4 id="this-loadservice"><a href="#this-loadservice" class="header-anchor">#</a> <code>this.loadService();</code></h4> <p>查找的 your_project_name/app/service/<strong>.js, 然后将文件名称作为一个作为属性，挂载在</strong>context**上下文上，然后将对应的 js 文件，暴露的方法赋值在这个属性上， 比如说我们在如下路径下： <code>your_project_name/app/service/home.js</code>, 其代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;span class=&quot;hljs-string&quot;&gt;'use strict'&lt;/span&gt;;

  // app/service/home.js
  const Service = require(&lt;span class=&quot;hljs-string&quot;&gt;'egg'&lt;/span&gt;).Service;

  class HomeService extends Service {
    async &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-title&quot;&gt;find&lt;/span&gt;&lt;/span&gt;() {
      // const user = await this.ctx.db.query(&lt;span class=&quot;hljs-string&quot;&gt;'select * from user where uid = ?'&lt;/span&gt;, uid);
      const user = [
        {
          name: &lt;span class=&quot;hljs-string&quot;&gt;'Ivan Fan'&lt;/span&gt;,
          age: 18,
        },
      ];
      &lt;span class=&quot;hljs-built_in&quot;&gt;return&lt;/span&gt; user;
    }
  }

  module.exports = HomeService;
  &lt;span class=&quot;copy-code-btn&quot;&gt;复制代码&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>我们在其他的地方就可以通过： <code>this.ctx.service.home.find()</code>方法调用 service 里面的方法了，如在 controller 中调用：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;span class=&quot;hljs-string&quot;&gt;'use strict'&lt;/span&gt;;
  const Controller = require(&lt;span class=&quot;hljs-string&quot;&gt;'egg'&lt;/span&gt;).Controller;
  class HomeController extends Controller {
    async &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-title&quot;&gt;index&lt;/span&gt;&lt;/span&gt;() {
      // this.ctx.body = &lt;span class=&quot;hljs-string&quot;&gt;'hi, egg'&lt;/span&gt;;
      this.ctx.body = await this.ctx.service.home.find();
    }
  }
  module.exports = HomeController;
  &lt;span class=&quot;copy-code-btn&quot;&gt;复制代码&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="this-loadmiddleware"><a href="#this-loadmiddleware" class="header-anchor">#</a> <code>this.loadMiddleware();</code></h4> <p>这个方法用来加载中间件，我们后面会单独来分析中间件</p> <h4 id="this-loadcontroller"><a href="#this-loadcontroller" class="header-anchor">#</a> <code>this.loadController();</code></h4> <p>这个方法是去加载 controller , 其代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
  <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  loadController(opt) {
      this.timing.start(&lt;span class=&quot;hljs-string&quot;&gt;'Load Controller'&lt;/span&gt;);
      opt = Object.assign({
        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt;Style: &lt;span class=&quot;hljs-string&quot;&gt;'lower'&lt;/span&gt;,
        directory: path.join(this.options.baseDir, &lt;span class=&quot;hljs-string&quot;&gt;'app/controller'&lt;/span&gt;),
        initializer: (obj, opt) =&amp;gt; {
          // &lt;span class=&quot;hljs-built_in&quot;&gt;return&lt;/span&gt; class &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; it exports a &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;
          // </span><span class="token template-punctuation string">`</span></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span>js
          <span class="token comment">// module.exports = app =&amp;gt; {</span>
          <span class="token comment">//   &lt;span class=&quot;hljs-built_in&quot;&gt;return&lt;/span&gt; class HomeController extends app.Controller {};</span>
          <span class="token comment">// }</span>
          <span class="token comment">// ```</span>
          <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-keyword&quot;</span><span class="token operator">&gt;</span><span class="token keyword">if</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span> <span class="token punctuation">(</span>is<span class="token punctuation">.</span><span class="token function">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>amp<span class="token punctuation">;</span><span class="token operator">&amp;</span>amp<span class="token punctuation">;</span> <span class="token operator">!</span>is<span class="token punctuation">.</span><span class="token function">generatorFunction</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">&amp;</span>amp<span class="token punctuation">;</span><span class="token operator">&amp;</span>amp<span class="token punctuation">;</span> <span class="token operator">!</span>is<span class="token punctuation">.</span><span class="token function">class</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">&amp;</span>amp<span class="token punctuation">;</span><span class="token operator">&amp;</span>amp<span class="token punctuation">;</span> <span class="token operator">!</span>is<span class="token punctuation">.</span><span class="token function">asyncFunction</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            obj <span class="token operator">=</span> <span class="token function">obj</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-keyword&quot;</span><span class="token operator">&gt;</span><span class="token keyword">if</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span> <span class="token punctuation">(</span>is<span class="token punctuation">.</span><span class="token function">class</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            obj<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>pathName <span class="token operator">=</span> opt<span class="token punctuation">.</span>pathName<span class="token punctuation">;</span>
            obj<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>fullPath <span class="token operator">=</span> opt<span class="token punctuation">.</span>path<span class="token punctuation">;</span>
            <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-built_in&quot;</span><span class="token operator">&gt;</span><span class="token keyword">return</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span> <span class="token function">wrapClass</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-keyword&quot;</span><span class="token operator">&gt;</span><span class="token keyword">if</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span> <span class="token punctuation">(</span>is<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-built_in&quot;</span><span class="token operator">&gt;</span><span class="token keyword">return</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span> <span class="token function">wrapObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> opt<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token comment">// support generatorFunction &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; forward compatbility</span>
          <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-keyword&quot;</span><span class="token operator">&gt;</span><span class="token keyword">if</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span> <span class="token punctuation">(</span>is<span class="token punctuation">.</span><span class="token function">generatorFunction</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">||</span> is<span class="token punctuation">.</span><span class="token function">asyncFunction</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-built_in&quot;</span><span class="token operator">&gt;</span><span class="token keyword">return</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span> <span class="token function">wrapObject</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'module.exports'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token operator">:</span> obj <span class="token punctuation">}</span><span class="token punctuation">,</span> opt<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'module.exports'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-built_in&quot;</span><span class="token operator">&gt;</span><span class="token keyword">return</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span> obj<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> opt<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> controllerBase <span class="token operator">=</span> opt<span class="token punctuation">.</span>directory<span class="token punctuation">;</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadToApp</span><span class="token punctuation">(</span>controllerBase<span class="token punctuation">,</span> <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'controller'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">,</span> opt<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'[egg:loader] Controller loaded: %s'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">,</span> controllerBase<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>timing<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'Load Controller'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;copy-code-btn&quot;</span><span class="token operator">&gt;</span>复制代码<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;/pre&gt;

其加载的路径是： app/controller 下面的 js 文件。然后将对应文件的名称挂载在 app.controller 上面，然后就可以通过如下方式，调用 controller 下面 js 暴露的方法：

  &lt;pre&gt;</span><span class="token template-punctuation string">`</span></span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> app <span class="token operator">=</span><span class="token operator">&amp;</span>gt<span class="token punctuation">;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> router<span class="token punctuation">,</span> controller <span class="token punctuation">}</span> <span class="token operator">=</span> app<span class="token punctuation">;</span>
    router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-string&quot;</span><span class="token operator">&gt;</span><span class="token string">'/'</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>home<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;copy-code-btn&quot;</span><span class="token operator">&gt;</span>复制代码<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>`<span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>

<span class="token literal-property property">上面也就是解决了我们一开始的疑问三</span><span class="token operator">:</span>

<span class="token operator">&gt;</span> <span class="token operator">-</span> <span class="token operator">&lt;</span>font color<span class="token operator">=</span><span class="token string">&quot;red&quot;</span><span class="token operator">&gt;</span>Controller 是如何绑定到 app 上面的 controller 对象上的<span class="token operator">?</span><span class="token operator">&lt;</span><span class="token operator">/</span>font<span class="token operator">&gt;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><h4 id="this-loadrouter"><a href="#this-loadrouter" class="header-anchor">#</a> <code>this.loadRouter();</code></h4> <p>这个方法,顾名思义就是去加载 router, 其代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
  <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-title&quot;&gt;loadRouter&lt;/span&gt;&lt;/span&gt;() {
      this.timing.start(&lt;span class=&quot;hljs-string&quot;&gt;'Load Router'&lt;/span&gt;);
      // 加载 router.js
      this.loadFile(this.resolveModule(path.join(this.options.baseDir, &lt;span class=&quot;hljs-string&quot;&gt;'app/router'&lt;/span&gt;)));
      this.timing.end(&lt;span class=&quot;hljs-string&quot;&gt;'Load Router'&lt;/span&gt;);
    },
  &lt;span class=&quot;copy-code-btn&quot;&gt;复制代码&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>

只会加载对应项目下的<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">app/router.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> 也就是路由应该只有一个入口文件<span class="token punctuation">.</span>如下 Demo<span class="token operator">:</span>

  <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;span class=&quot;hljs-string&quot;&gt;'use strict'&lt;/span&gt;;

  /**
   * @param {Egg.Application} app - egg application
   */
  module.exports = app =&amp;gt; {
    const { router, controller } = app;
    router.get(&lt;span class=&quot;hljs-string&quot;&gt;'/'&lt;/span&gt;, controller.home.index);
  };

  &lt;span class=&quot;copy-code-btn&quot;&gt;复制代码&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>如上代码实现路由。但是我们只是给对应的路由添加了方法， 但是如何去监听路由变化，然后调用不同的方法呢？ 这个涉及到<strong>koa</strong> 中间件的使用方法，我们后续会单独分析中间件, 以及<strong>koa-router</strong></p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <ol><li>egg 的核心模块包括 Application(egg/lib/applicaton.js) <font color="red" size="5">-----&gt;</font> EggApplication(egg/lib/egg.js) <font color="red" size="5">-----&gt;</font> EggCore(egg-core/lib/egg.js) <font color="red" size="5">-----&gt;</font> <font size="5"> KoaApplication(<font color="red">koa</font>)</font></li> <li>eggjs 会通过 loadConfig() 去加载配置文件</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-title&quot;&gt;loadConfig&lt;/span&gt;&lt;/span&gt;() {
        this.loadPlugin();
        super.loadConfig();
      }
    &lt;span class=&quot;copy-code-btn&quot;&gt;复制代码&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="3"><li>会通过 load() 方法去加载一系列相关配置</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span>`  <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-function&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hljs-title&quot;</span><span class="token operator">&gt;</span>load<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// app &amp;gt; plugin &amp;gt; core</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadApplicationExtend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadRequestExtend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadResponseExtend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadContextExtend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadHelperExtend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// app &amp;gt; plugin</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadCustomApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// app &amp;gt; plugin</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// app &amp;gt; plugin &amp;gt; core</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// app</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// app</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Dependent on controllers</span>
      <span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;copy-code-btn&quot;</span><span class="token operator">&gt;</span>复制代码<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></figure></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/19-Node/02-NodeServer.html" class="prev">
        NodeSever主流框架横评
      </a></span> <span class="next"><a href="/19-Node/05-Nest.html">
        NodeSever-Nest
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.553118a3.js" defer></script><script src="/assets/js/2.0b4d76ae.js" defer></script><script src="/assets/js/187.520f3a72.js" defer></script>
  </body>
</html>
